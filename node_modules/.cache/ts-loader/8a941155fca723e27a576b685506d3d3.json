{"remainingRequest":"H:\\桌面\\showtimecodeweb\\node_modules\\babel-loader\\lib\\index.js!H:\\桌面\\showtimecodeweb\\node_modules\\ts-loader\\index.js??ref--14-2!H:\\桌面\\showtimecodeweb\\src\\http\\requert.ts","dependencies":[{"path":"H:\\桌面\\showtimecodeweb\\src\\http\\requert.ts","mtime":1651123523691},{"path":"H:\\桌面\\showtimecodeweb\\babel.config.js","mtime":1642330622538},{"path":"H:\\桌面\\showtimecodeweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1642330605221},{"path":"H:\\桌面\\showtimecodeweb\\node_modules\\babel-loader\\lib\\index.js","mtime":1642330607368},{"path":"H:\\桌面\\showtimecodeweb\\node_modules\\ts-loader\\index.js","mtime":1642330608824}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJIOlxcXHU2ODRDXHU5NzYyXFxzaG93dGltZWNvZGV3ZWJcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxpbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyIpOwoKdmFyIF9jb25maWcgPSByZXF1aXJlKCJAL2NvbmZpZyIpOwoKdmFyIF9yb3V0ZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvcm91dGVyIikpOwoKdmFyIF9tZXNzYWdlSW5mbyA9IHJlcXVpcmUoIkAvdXRpbHMvbWVzc2FnZUluZm8iKTsKCnZhciBfYXhpb3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImF4aW9zIikpOwoKdmFyIF9lbGVtZW50UGx1cyA9IHJlcXVpcmUoImVsZW1lbnQtcGx1cyIpOwoKdmFyIGxvYWRpbmc7IC8vIGNyZWF0ZSBhbiBheGlvcyBpbnN0YW5jZQoKdmFyIHNlcnZpY2UgPSBfYXhpb3MuZGVmYXVsdC5jcmVhdGUoewogIGJhc2VVUkw6IF9jb25maWcuYmFzZVVSTCwKICAvLyB3aXRoQ3JlZGVudGlhbHM6IHRydWUsIC8vIHNlbmQgY29va2llcyB3aGVuIGNyb3NzLWRvbWFpbiByZXF1ZXN0cwogIHRpbWVvdXQ6IDIwMDAwIC8vIHJlcXVlc3QgdGltZW91dAoKfSk7Cgp2YXIgc3RhcnRMb2FkaW5nID0gZnVuY3Rpb24gc3RhcnRMb2FkaW5nKCkgewogIDsKICB2YXIgb3B0aW9ucyA9IHsKICAgIGxvY2s6IHRydWUsCiAgICB0ZXh0OiAi5Yqg6L295LitLi4uIiwKICAgIGJhY2tncm91bmQ6ICdyZ2JhKDAsMCwwLDAuNyknCiAgfTsKICBsb2FkaW5nID0gX2VsZW1lbnRQbHVzLkVsTG9hZGluZy5zZXJ2aWNlKG9wdGlvbnMpOwp9OwoKdmFyIGdldFRva2VuID0gZnVuY3Rpb24gZ2V0VG9rZW4oKSB7CiAgdmFyIHRva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2Nlc3NfdG9rZW4nKTsKCiAgaWYgKHRva2VuID09PSBudWxsIHx8IHRva2VuID09PSAnJykgewogICAgcmV0dXJuIGdldFRva2VuKCk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc190b2tlbicpOwogIH0KfTsKCnZhciBlbmRMb2FkaW5nID0gZnVuY3Rpb24gZW5kTG9hZGluZygpIHsKICBsb2FkaW5nLmNsb3NlKCk7Cn07IC8vIOivt+axguaLpuaIqgoKCnNlcnZpY2UuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICAvLyDliqDovb0KICBzdGFydExvYWRpbmcoKTsKCiAgaWYgKGNvbmZpZy51cmwgIT09ICdhcGkvYWNjb3VudC9sb2dpbicpIHsKICAgIHZhciBfZ2V0VG9rZW47CgogICAgY29uZmlnLmhlYWRlcnMgPSB7CiAgICAgIEF1dGhvcml6YXRpb246IChfZ2V0VG9rZW4gPSBnZXRUb2tlbigpKSAhPT0gbnVsbCAmJiBfZ2V0VG9rZW4gIT09IHZvaWQgMCA/IF9nZXRUb2tlbiA6ICcnCiAgICB9OwogIH0KCiAgcmV0dXJuIGNvbmZpZzsKfSk7IC8vIOWTjeW6lOaLpuaIqgoKc2VydmljZS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXNwb25zZSkgewogIC8vIOe7k+adn2xvYWRpbmcKICBlbmRMb2FkaW5nKCk7IC8v5LiN5ZCM55u45bqU5omA57uZ55qE5o+Q56S6CgogIGlmIChyZXNwb25zZS5kYXRhKSB7CiAgICAoMCwgX21lc3NhZ2VJbmZvLm1hc3NhZ2VTaG93KShyZXNwb25zZS5kYXRhLnN0YXRlLCByZXNwb25zZS5kYXRhLm1hc3NhZ2UpOwogIH0KCiAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIHZhciBfZXJyb3IkcmVzcG9uc2U7CgogIC8vIOe7k+adn2xvYWRpbmcKICBlbmRMb2FkaW5nKCk7IC8v6L+H5pyf5o+Q56S6CgogIGlmICgoKF9lcnJvciRyZXNwb25zZSA9IGVycm9yLnJlc3BvbnNlKSA9PT0gbnVsbCB8fCBfZXJyb3IkcmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lcnJvciRyZXNwb25zZS5oZWFkZXJzWyd0b2tlbi1leHBpcmVkJ10pID09ICd0cnVlJykgewogICAgKDAsIF9tZXNzYWdlSW5mby5tYXNzYWdlU2hvdykoMSwgIueZu+W9lei/h+acnyIpOwogICAgd2luZG93LmxvY2FsU3RvcmFnZS5jbGVhcigpOwoKICAgIF9yb3V0ZXIuZGVmYXVsdC5wdXNoKCcvJyk7CiAgfSBlbHNlIHsKICAgIC8vIOmUmeivr+aPkOmGkgogICAgKDAsIF9tZXNzYWdlSW5mby5tYXNzYWdlU2hvdykoMSwgZXJyb3IubWVzc2FnZSk7CiAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTsKICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgfQp9KTsKdmFyIF9kZWZhdWx0ID0gc2VydmljZTsKZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7"},{"version":3,"sources":["H:\\桌面\\showtimecodeweb\\src\\http\\requert.ts"],"names":[],"mappings":";;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA,IAAI,OAAJ,C,CACA;;AACA,IAAM,OAAO,GAAG,eAAM,MAAN,CAAa;AAC3B,EAAA,OAAO,EAAE,eADkB;AAE3B;AACA,EAAA,OAAO,EAAE,KAHkB,CAGZ;;AAHY,CAAb,CAAhB;;AAKA,IAAM,YAAY,GAAG,SAAf,YAAe,GAAK;AAMvB;AAED,MAAM,OAAO,GAAY;AACvB,IAAA,IAAI,EAAE,IADiB;AAEvB,IAAA,IAAI,EAAE,QAFiB;AAGvB,IAAA,UAAU,EAAE;AAHW,GAAzB;AAKA,EAAA,OAAO,GAAG,uBAAU,OAAV,CAAkB,OAAlB,CAAV;AACD,CAdD;;AAgBA,IAAM,QAAQ,GAAG,SAAX,QAAW,GAAoB;AACnC,MAAI,KAAK,GAAkB,MAAM,CAAC,YAAP,CAAoB,OAApB,CAA4B,cAA5B,CAA3B;;AACA,MAAI,KAAK,KAAK,IAAV,IAAkB,KAAK,KAAK,EAAhC,EAAoC;AAClC,WAAO,QAAQ,EAAf;AACD,GAFD,MAEO;AACL,WAAO,MAAM,CAAC,YAAP,CAAoB,OAApB,CAA4B,cAA5B,CAAP;AACD;AACF,CAPD;;AAQA,IAAM,UAAU,GAAG,SAAb,UAAa,GAAK;AACtB,EAAA,OAAO,CAAC,KAAR;AACD,CAFD,C,CAGA;;;AACA,OAAO,CAAC,YAAR,CAAqB,OAArB,CAA6B,GAA7B,CAAiC,UAAC,MAAD,EAA+B;AAC9D;AACA,EAAA,YAAY;;AACZ,MAAI,MAAM,CAAC,GAAP,KAAe,mBAAnB,EAAwC;AAAA;;AACtC,IAAA,MAAM,CAAC,OAAP,GAAiB;AACf,MAAA,aAAa,eAAE,QAAQ,EAAV,iDAAgB;AADd,KAAjB;AAGD;;AACD,SAAO,MAAP;AACD,CATD,E,CAYA;;AACA,OAAO,CAAC,YAAR,CAAqB,QAArB,CAA8B,GAA9B,CAAkC,UAAC,QAAD,EAAiC;AACjE;AACA,EAAA,UAAU,GAFuD,CAGjE;;AACA,MAAI,QAAQ,CAAC,IAAb,EAAmB;AACjB,kCAAY,QAAQ,CAAC,IAAT,CAAc,KAA1B,EAAiC,QAAQ,CAAC,IAAT,CAAc,OAA/C;AACD;;AACD,SAAO,QAAQ,CAAC,IAAhB;AACD,CARD,EAQG,UAAC,KAAD,EAAsB;AAAA;;AACvB;AACA,EAAA,UAAU,GAFa,CAGvB;;AACA,MAAI,oBAAA,KAAK,CAAC,QAAN,oEAAgB,OAAhB,CAAwB,eAAxB,MAA4C,MAAhD,EAAwD;AACtD,kCAAY,CAAZ,EAAe,MAAf;AACA,IAAA,MAAM,CAAC,YAAP,CAAoB,KAApB;;AACA,oBAAO,IAAP,CAAY,GAAZ;AACD,GAJD,MAIO;AACL;AACA,kCAAY,CAAZ,EAAe,KAAK,CAAC,OAArB;AACA,IAAA,OAAO,CAAC,GAAR,CAAY,KAAK,CAAC,OAAlB;AACA,WAAO,OAAO,CAAC,MAAR,CAAe,KAAf,CAAP;AACD;AAEF,CAvBD;eAyBe,O","sourcesContent":["\r\nimport { baseURL } from '@/config';\r\nimport router from '@/router';\r\nimport { massageShow } from '@/utils/messageInfo';\r\nimport axios, { AxiosError, AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport { ElLoading } from 'element-plus';\r\n\r\n\r\nlet loading: any;\r\n// create an axios instance\r\nconst service = axios.create({\r\n  baseURL: baseURL, \r\n  // withCredentials: true, // send cookies when cross-domain requests\r\n  timeout: 20000 // request timeout\r\n})\r\nconst startLoading = () => {\r\n\r\n  interface Options {\r\n    lock: boolean;\r\n    text: string;\r\n    background: string;\r\n  };\r\n\r\n  const options: Options = {\r\n    lock: true,\r\n    text: \"加载中...\",\r\n    background: 'rgba(0,0,0,0.7)'\r\n  }\r\n  loading = ElLoading.service(options);\r\n}\r\n\r\nconst getToken = (): string | null => {\r\n  let token: string | null = window.localStorage.getItem('access_token')\r\n  if (token === null || token === '') {\r\n    return getToken()\r\n  } else {\r\n    return window.localStorage.getItem('access_token')\r\n  }\r\n}\r\nconst endLoading = () => {\r\n  loading.close();\r\n}\r\n// 请求拦截\r\nservice.interceptors.request.use((config: AxiosRequestConfig) => {\r\n  // 加载\r\n  startLoading();\r\n  if (config.url !== 'api/account/login') {\r\n    config.headers = {\r\n      Authorization: getToken() ?? ''\r\n    }\r\n  }\r\n  return config;\r\n})\r\n\r\n\r\n// 响应拦截\r\nservice.interceptors.response.use((response: AxiosResponse<any>) => {\r\n  // 结束loading\r\n  endLoading();\r\n  //不同相应所给的提示\r\n  if (response.data) {\r\n    massageShow(response.data.state, response.data.massage)\r\n  }\r\n  return response.data;\r\n}, (error: AxiosError) => {\r\n  // 结束loading\r\n  endLoading();\r\n  //过期提示\r\n  if (error.response?.headers['token-expired'] == 'true') {\r\n    massageShow(1, \"登录过期\")\r\n    window.localStorage.clear()\r\n    router.push('/')\r\n  } else {\r\n    // 错误提醒\r\n    massageShow(1, error.message)\r\n    console.log(error.message)\r\n    return Promise.reject(error);\r\n  }\r\n\r\n})\r\n\r\nexport default service;"],"sourceRoot":""}]}